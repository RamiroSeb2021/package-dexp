% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/metodo_Harris_Hurvitz_Mood.R
\name{calcular_r_minimo_HHM}
\alias{calcular_r_minimo_HHM}
\title{Cálculo iterativo del número mínimo de réplicas usando el método de Harris–Hurvitz–Mood (HHM)}
\usage{
calcular_r_minimo_HHM(
  t,
  d,
  r_inicial,
  S1_sq,
  df1,
  alpha_ = 0.05,
  beta_ = 0.8,
  max_error = 0.01,
  max_iter = 1000
)
}
\arguments{
\item{t}{Número de tratamientos.}

\item{d}{Diferencia mínima detectable entre medias.}

\item{r_inicial}{Valor inicial para el número de réplicas.}

\item{S1_sq}{Estimación de la varianza experimental (\code{S1^2}).}

\item{df1}{Grados de libertad asociados al estimador de varianza experimental.}

\item{alpha_}{Nivel de significancia (por defecto \code{0.05}).}

\item{beta_}{Error tipo II (\code{1 - potencia deseada}, por defecto \code{0.8}).}

\item{max_error}{Error relativo máximo permitido para la convergencia (por defecto \code{0.01}).}

\item{max_iter}{Número máximo de iteraciones permitidas (por defecto \code{1000}).}
}
\value{
Una lista con los siguientes elementos:
\describe{
\item{r}{Número mínimo de réplicas requeridas (redondeado hacia arriba).}
\item{S1}{Desviación estándar estimada a partir de \code{S1_sq}.}
\item{df1}{Grados de libertad del estimador de varianza experimental.}
\item{df2}{Grados de libertad del error al finalizar la iteración.}
\item{dif}{Diferencia mínima detectable utilizada.}
\item{alfa}{Nivel de significancia.}
\item{iteraciones}{Número de iteraciones realizadas.}
\item{convergencia}{\code{TRUE} si se alcanzó convergencia; \code{FALSE} si se alcanzó el límite de iteraciones.}
\item{K_}{Valor de \(k = a / s_1\) que garantiza la potencia deseada, obtenido por simulación Monte Carlo mediante \code{k_tabla_mc()}.}
}
}
\description{
Esta función estima de forma iterativa el número mínimo de réplicas necesarias \code{r}
en un diseño experimental con múltiples tratamientos, empleando el método de Harris–Hurvitz–Mood (HHM).
La estimación se basa en el ajuste simultáneo de \code{df2}, el valor de \code{K'} proveniente de la tabla
de potencia (calculado mediante \code{k_tabla_mc}), y la fórmula:
}
\details{
\deqn{
  r = 2(df_2 + 1)\left(\frac{K' \cdot S_1}{d}\right)^2
}

El proceso se repite hasta que el cambio relativo entre iteraciones sucesivas sea menor a un umbral
especificado por \code{max_error}, o hasta alcanzar el número máximo de iteraciones.

Esta función es útil en contextos donde el valor de \code{K'} depende del número de grados de libertad
\code{df2}, que a su vez depende de \code{r}. El proceso iterativo ajusta ambos hasta que el número
de réplicas requerido estabiliza su valor.
}
\examples{
resultados <- calcular_r_minimo_HHM(
  t = 6,
  d = 20,
  r_inicial = 3,
  S1_sq = 141.6,
  df1 = 40,
  alpha_ = 0.05,
  beta_ = 0.8
)

resultados$r      # número estimado de réplicas
resultados$K_     # valor de K = a / s1 obtenido por simulación
resultados$df2    # grados de libertad del error final

}
\seealso{
\code{\link{k_tabla_mc}}, \code{\link{obtener_K_A9}}, \code{\link{calcular_df2}}
}
